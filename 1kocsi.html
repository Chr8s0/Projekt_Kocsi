<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Generálás</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Excel Generálás - 500 Autó</h1>
    <button onclick="generateExcel()">Excel Létrehozása</button>

    <script>
        // Alapszínek
        const colors = ['Fekete', 'Fehér', 'Piros', 'Kék', 'Szürke', 'Zöld', 'Sárga', 'Narancs', 'Lila', 'Barna'];

        // Márkák és modellek
        const brandsAndModels = {
            'Toyota': ['Corolla', 'Camry', 'Yaris'],
            'Ford': ['Focus', 'Fiesta', 'Mustang'],
            'Volkswagen': ['Golf', 'Passat', 'Polo'],
            'BMW': ['3 Series', '5 Series', 'X5'],
            'Audi': ['A4', 'Q5', 'A3']
        };

        // Eladók adatai
        const sellers = [
            {name: 'Nagy László', phone: '06' + generatePhoneNumber()},
            {name: 'Kovács Péter', phone: '06' + generatePhoneNumber()},
            {name: 'Szabó Anna', phone: '06' + generatePhoneNumber()},
            {name: 'Tóth Gábor', phone: '06' + generatePhoneNumber()},
            {name: 'Kiss János', phone: '06' + generatePhoneNumber()},
            {name: 'Farkas Ilona', phone: '06' + generatePhoneNumber()},
            {name: 'Németh Erika', phone: '06' + generatePhoneNumber()},
            {name: 'Molnár Tibor', phone: '06' + generatePhoneNumber()},
            {name: 'Lakatos Tamás', phone: '06' + generatePhoneNumber()},
            {name: 'Balogh Zsolt', phone: '06' + generatePhoneNumber()},
            {name: 'Szilágyi Judit', phone: '06' + generatePhoneNumber()},
            {name: 'Horváth Béla', phone: '06' + generatePhoneNumber()},
            {name: 'Varga Krisztián', phone: '06' + generatePhoneNumber()},
            {name: 'Kocsis Éva', phone: '06' + generatePhoneNumber()},
            {name: 'Nagy István', phone: '06' + generatePhoneNumber()},
            {name: 'Szalai Mária', phone: '06' + generatePhoneNumber()},
            {name: 'Bíró Attila', phone: '06' + generatePhoneNumber()},
            {name: 'Váradi Balázs', phone: '06' + generatePhoneNumber()},
            {name: 'Mészáros Andrea', phone: '06' + generatePhoneNumber()},
            {name: 'Pintér Katalin', phone: '06' + generatePhoneNumber()},
        ];

        // Egyedi rendszámok készlet
        const licensePlatesSet = new Set();

        // Véletlenszerű rendszám generálása ismétlődés nélkül
        function generateUniqueLicensePlate() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const numbers = '0123456789';
            let plate = '';

            do {
                plate = '';
                // 4 véletlen betű
                for (let i = 0; i < 4; i++) {
                    plate += letters.charAt(Math.floor(Math.random() * letters.length));
                }

                plate += '-';

                // 3 véletlen szám
                for (let i = 0; i < 3; i++) {
                    plate += numbers.charAt(Math.floor(Math.random() * numbers.length));
                }
            } while (licensePlatesSet.has(plate)); // Ha már létezik, újrageneráljuk

            licensePlatesSet.add(plate); // Hozzáadás a halmazhoz
            return plate;
        }

        // Véletlenszerű telefonszám generálása 9 számjeggyel
        function generatePhoneNumber() {
            const numbers = '0123456789';
            let phoneNumber = '';
            for (let i = 0; i < 9; i++) {
                phoneNumber += numbers.charAt(Math.floor(Math.random() * numbers.length));
            }
            return phoneNumber;
        }

        // Véletlenszerű egyedi ár generálása ismétlődés nélkül
        const pricesSet = new Set();
        function generateUniquePrice(min = 1000000, max = 5000000) {
            let price;
            do {
                price = Math.floor(Math.random() * (max - min + 1)) + min;
            } while (pricesSet.has(price));
            pricesSet.add(price);
            return price;
        }

        // Excel generálása
        function generateExcel() {
            const licensePlates = [];    // Rendszámok tábla
            const brandData = [];        // Márkák tábla
            const modelData = [];        // Modellek tábla
            const colorData = [];        // Színek tábla
            const sellerData = [];       // Eladó tábla
            const combinedData = [];     // Kombinált tábla (rendszámok mellé azonosítók és árak)

            // Színek tábla kitöltése
            colors.forEach((color, index) => {
                colorData.push([index + 1, color]);
            });

            // Márkák és modellek kitöltése
            let brandId = 1;
            let modelId = 1;
            for (const brand in brandsAndModels) {
                // Márkák táblázata
                brandData.push([brandId, brand]);

                // Modellek táblázata
                brandsAndModels[brand].forEach(model => {
                    modelData.push([modelId, brandId, model]);
                    modelId++;
                });

                brandId++;
            }

            // Eladó tábla kitöltése
            sellers.forEach((seller, index) => {
                sellerData.push([index + 1, seller.name, seller.phone]);
            });

            // Rendszámok és azonosítók generálása
            for (let i = 0; i < 500; i++) {
                const licensePlate = generateUniqueLicensePlate();
                const randomBrandId = Math.floor(Math.random() * brandData.length) + 1;
                const randomColorId = Math.floor(Math.random() * colorData.length) + 1;
                const randomModelId = Math.floor(Math.random() * modelData.length) + 1;
                const randomPrice = generateUniquePrice();

                licensePlates.push([i + 1, licensePlate]);
                combinedData.push([i + 1, licensePlate, randomBrandId, randomColorId, randomModelId, randomPrice]);
            }

            // Excel munkalapok létrehozása
            const workbook = XLSX.utils.book_new();

            // Rendszámok tábla
            const platesSheet = XLSX.utils.aoa_to_sheet([['Azonosító', 'Rendszám']]);
            XLSX.utils.sheet_add_aoa(platesSheet, licensePlates, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, platesSheet, "Rendszám");

            // Márkák tábla
            const brandsSheet = XLSX.utils.aoa_to_sheet([['Márka azonosító', 'Márka']]);
            XLSX.utils.sheet_add_aoa(brandsSheet, brandData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, brandsSheet, "Márka_azonosító");

            // Színek tábla
            const colorsSheet = XLSX.utils.aoa_to_sheet([['Szín azonosító', 'Szín']]);
            XLSX.utils.sheet_add_aoa(colorsSheet, colorData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, colorsSheet, "Szín_azonosító");

            // Modellek tábla
            const modelsSheet = XLSX.utils.aoa_to_sheet([['Modell azonosító', 'Márka azonosító', 'Modell']]);
            XLSX.utils.sheet_add_aoa(modelsSheet, modelData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, modelsSheet, "Modell_azonosító");

            // Eladó tábla
            const sellersSheet = XLSX.utils.aoa_to_sheet([['Eladó azonosító', 'Név', 'Telefonszám']]);
            XLSX.utils.sheet_add_aoa(sellersSheet, sellerData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, sellersSheet, "Eladó");

            // Kombinált tábla
            const combinedSheet = XLSX.utils.aoa_to_sheet([['Azonosító', 'Rendszám', 'Márka azonosító', 'Szín azonosító', 'Modell azonosító', 'Ár']]);
            XLSX.utils.sheet_add_aoa(combinedSheet, combinedData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, combinedSheet, "Auto");

            // Excel fájl letöltése
            XLSX.writeFile(workbook, 'autok_500_uj.xlsx');
        }
    </script>
</body>
</html>
