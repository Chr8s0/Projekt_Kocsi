<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Generálás</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Excel Generálás - 500 Autó</h1>
    <button onclick="generateExcel()">Excel Létrehozása</button>

    <script>
        const colors = ['Fekete', 'Fehér', 'Piros', 'Kék', 'Szürke', 'Zöld', 'Sárga', 'Narancs', 'Lila', 'Barna'];
        const brandsAndModels = {
            'Toyota': ['Corolla', 'Camry', 'Yaris'],
            'Ford': ['Focus', 'Fiesta', 'Mustang'],
            'Volkswagen': ['Golf', 'Passat', 'Polo'],
            'BMW': ['3 Series', '5 Series', 'X5'],
            'Audi': ['A4', 'Q5', 'A3']
        };
        const engineTypes = ['Benzines', 'Dízel', 'Elektromos', 'Hibrid'];
        const engineSpecs = {
            'Benzines': ['2.0L I4', '3.0L V6'],
            'Dízel': ['2.0L I4', '3.0L V6'],
            'Elektromos': ['300kW', '400kW'],
            'Hibrid': ['1.5L I4 Hybrid', '2.0L I4 Hybrid']
        };
        const environmentUsage = ['Város', 'Autópálya', 'Vegyes'];
        const sellers = [
            {name: 'Nagy László', phone: '06' + generatePhoneNumber()},
            {name: 'Kovács Péter', phone: '06' + generatePhoneNumber()},
            {name: 'Szabó Anna', phone: '06' + generatePhoneNumber()},
            {name: 'Tóth Katalin', phone: '06' + generatePhoneNumber()},
            {name: 'Varga Zoltán', phone: '06' + generatePhoneNumber()},
            // Add more sellers as needed
        ];
        const transmissionTypes = ['Automata', 'Manuális'];
        const licensePlatesSet = new Set();

        function generateUniqueLicensePlate() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const numbers = '0123456789';
            let plate = '';
            do {
                plate = '';
                for (let i = 0; i < 4; i++) {
                    plate += letters.charAt(Math.floor(Math.random() * letters.length));
                }
                plate += '-';
                for (let i = 0; i < 3; i++) {
                    plate += numbers.charAt(Math.floor(Math.random() * numbers.length));
                }
            } while (licensePlatesSet.has(plate));
            licensePlatesSet.add(plate);
            return plate;
        }

        function generatePhoneNumber() {
            const numbers = '0123456789';
            let phoneNumber = '';
            for (let i = 0; i < 9; i++) {
                phoneNumber += numbers.charAt(Math.floor(Math.random() * numbers.length));
            }
            return phoneNumber;
        }

        function generateYear() {
            return Math.floor(Math.random() * (2023 - 2000 + 1)) + 2000;
        }

        function generateMileage() {
            return Math.floor(Math.random() * (300000 - 5000 + 1)) + 5000 + ' km';
        }

        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.') + ' Ft';
        }

        function getRealisticPrice(brand, model, year, mileage) {
            let basePrice;
            switch (brand) {
                case 'Toyota': basePrice = 3000000; break;
                case 'Ford': basePrice = 3500000; break;
                case 'Volkswagen': basePrice = 4000000; break;
                case 'BMW': basePrice = 5000000; break;
                case 'Audi': basePrice = 4500000; break;
                default: basePrice = 2000000;
            }
            const ageFactor = (2023 - year) * 0.05;
            const mileageFactor = parseInt(mileage) / 100000 * 0.02;
            const price = basePrice - basePrice * (ageFactor + mileageFactor);
            return Math.min(100000000, Math.max(1000000, price));
        }

        function generateExcel() {
            const licensePlates = [];
            const brandData = [];
            const modelData = [];
            const colorData = [];
            const sellerData = [];
            const combinedData = [];
            const transmissionData = [];

            colors.forEach((color, index) => {
                colorData.push([index + 1, color]);
            });

            let brandId = 1;
            let modelId = 1;
            for (const brand in brandsAndModels) {
                brandData.push([brandId, brand]);
                brandsAndModels[brand].forEach(model => {
                    modelData.push([modelId, brandId, model]);
                    modelId++;
                });
                brandId++;
            }

            sellers.forEach((seller, index) => {
                sellerData.push([index + 1, seller.name, seller.phone]);
            });

            transmissionTypes.forEach((type, index) => {
                transmissionData.push([index + 1, type]);
            });

            for (let i = 0; i < 500; i++) {
                const licensePlate = generateUniqueLicensePlate();
                const randomBrandId = Math.floor(Math.random() * brandData.length) + 1;
                const randomColorId = Math.floor(Math.random() * colorData.length) + 1;
                const randomModelId = Math.floor(Math.random() * modelData.length) + 1;
                const randomTransmissionId = Math.floor(Math.random() * transmissionData.length) + 1;
                const year = generateYear();
                const mileage = generateMileage();
                const usage = environmentUsage[Math.floor(Math.random() * environmentUsage.length)];
                const engineType = engineTypes[Math.floor(Math.random() * engineTypes.length)];
                const engineSpec = engineSpecs[engineType][Math.floor(Math.random() * engineSpecs[engineType].length)];
                const price = formatPrice(getRealisticPrice(brandData[randomBrandId - 1][1], modelData[randomModelId - 1][2], year, mileage));

                const engineDescription = `${engineType} motor, ${engineSpec}, ${mileage}, ${usage} használat`;

                combinedData.push([i + 1, licensePlate, randomBrandId, randomColorId, randomModelId, year, mileage, engineType, engineDescription, randomTransmissionId, price]);
            }

            const workbook = XLSX.utils.book_new();

            const platesSheet = XLSX.utils.aoa_to_sheet([['Azonosító', 'Rendszám']]);
            XLSX.utils.sheet_add_aoa(platesSheet, licensePlates, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, platesSheet, "Rendszám");

            const brandSheet = XLSX.utils.aoa_to_sheet([['Márka azonosító', 'Márka']]);
            XLSX.utils.sheet_add_aoa(brandSheet, brandData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, brandSheet, "Márkák");

            const modelSheet = XLSX.utils.aoa_to_sheet([['Modell azonosító', 'Márka azonosító', 'Modell']]);
            XLSX.utils.sheet_add_aoa(modelSheet, modelData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, modelSheet, "Modellek");

            const colorSheet = XLSX.utils.aoa_to_sheet([['Szín azonosító', 'Szín']]);
            XLSX.utils.sheet_add_aoa(colorSheet, colorData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, colorSheet, "Színek");

            const sellerSheet = XLSX.utils.aoa_to_sheet([['Eladó azonosító', 'Név', 'Telefon']]);
            XLSX.utils.sheet_add_aoa(sellerSheet, sellerData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, sellerSheet, "Eladók");

            const transmissionSheet = XLSX.utils.aoa_to_sheet([['Sebességváltó azonosító', 'Sebességváltó']]);
            XLSX.utils.sheet_add_aoa(transmissionSheet, transmissionData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, transmissionSheet, "Sebességváltók");

            const carSheet = XLSX.utils.aoa_to_sheet([['Azonosító', 'Rendszám', 'Márka ID', 'Szín ID', 'Modell ID', 'Évjárat', 'Kilométeróra állás', 'Motortípus', 'Motor leírás', 'Sebességváltó ID', 'Ár']]);
            XLSX.utils.sheet_add_aoa(carSheet, combinedData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, carSheet, "Autók");

            XLSX.writeFile(workbook, "Autók.xlsx");
        }
    </script>
</body>
</html>
