<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vásárlók Excel Generálás</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Vásárlók Excel Generálás</h1>
    <button onclick="generateBuyerExcel()">Vásárlók Excel Létrehozása</button>

    <script>
        const buyers = [
            {name: 'Kiss Gábor', phone: '06' + generatePhoneNumber()},
            {name: 'Nagy Judit', phone: '06' + generatePhoneNumber()},
            {name: 'Tóth Béla', phone: '06' + generatePhoneNumber()},
            {name: 'Szabó Eszter', phone: '06' + generatePhoneNumber()},
            {name: 'Varga Gergely', phone: '06' + generatePhoneNumber()},
            {name: 'Kovács Zsolt', phone: '06' + generatePhoneNumber()},
            {name: 'Molnár Réka', phone: '06' + generatePhoneNumber()},
            {name: 'Horváth Lajos', phone: '06' + generatePhoneNumber()},
            {name: 'Farkas Anikó', phone: '06' + generatePhoneNumber()},
            {name: 'Balogh Norbert', phone: '06' + generatePhoneNumber()}
        ];
        const brandsAndModels = {
            'Toyota': ['Corolla', 'Camry', 'Yaris'],
            'Ford': ['Focus', 'Fiesta', 'Mustang'],
            'Volkswagen': ['Golf', 'Passat', 'Polo'],
            'BMW': ['3 Series', '5 Series', 'X5'],
            'Audi': ['A4', 'Q5', 'A3']
        };

        function generatePhoneNumber() {
            const numbers = '0123456789';
            let phoneNumber = '';
            for (let i = 0; i < 9; i++) {
                phoneNumber += numbers.charAt(Math.floor(Math.random() * numbers.length));
            }
            return phoneNumber;
        }

        function generateBuyerExcel() {
            const buyerData = [];
            const modelData = [];

            let modelId = 1;
            for (const brand in brandsAndModels) {
                brandsAndModels[brand].forEach(model => {
                    modelData.push([modelId, brand, model]);
                    modelId++;
                });
            }

            for (let i = 0; i < 500; i++) {
                const randomBuyer = buyers[Math.floor(Math.random() * buyers.length)];
                const randomModelId = Math.floor(Math.random() * modelData.length) + 1;
                buyerData.push([i + 1, randomBuyer.name, randomBuyer.phone, randomModelId]);
            }

            const workbook = XLSX.utils.book_new();

            const buyerSheet = XLSX.utils.aoa_to_sheet([['Vásárló azonosító', 'Név', 'Telefon', 'Modell azonosító']]);
            XLSX.utils.sheet_add_aoa(buyerSheet, buyerData, {origin: "A2"});
            XLSX.utils.book_append_sheet(workbook, buyerSheet, "Vásárlók");

            XLSX.writeFile(workbook, "Vasarlok.xlsx");
        }
    </script>
</body>
</html>
